---
title: "Activity_Report"
author: "Michael Garcia"
date: "August 1, 2017"
output:
  html_notebook: default
  pdf_document: default
  word_document: default
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Cmd+Shift+Enter*.

#### 1) Read and Process Data

```{r include = TRUE, echo = TRUE}
library(data.table)

webURL <- "https://d396qusza40orc.cloudfront.net/repdata%2Fdata%2Factivity.zip"
destURL <- file.path(getwd(),paste("activity_monitoring_data",".zip",sep = ""))
localFileURL <- file.path(getwd(),paste("activity",".csv",sep = ""))
download.file(webURL,destfile = destURL)

unzip(destURL)
#activityData <- as.data.frame(read.csv(localFileURL))
activityData <- read.csv(localFileURL, quote = "\"",stringsAsFactors = FALSE)
activityData$steps <- as.numeric(activityData$steps)
activityData$interval <- as.numeric(activityData$interval)
activityData$date <- as.Date(activityData$date,format = "%Y-%m-%d")

```


#### 2) Histogram of the total number of steps taken each day




``` {r include = TRUE, echo = TRUE}
#   2) Histogram of the total number of steps taken each day
activityDataAg <- aggregate(activityData$steps,list(activityData$date),sum)
names(activityDataAg) <- c("date","totalSteps")
#activityDataAg <- activityDataAg[complete.cases(activityDataAg),]
hist(activityDataAg$totalSteps, xlab = "TotalSteps", breaks = 10)
```

The total median steps are `r stepsMedian` and the mean for the total steps taken is `r stepsMean`

``` {r include = TRUE, echo = TRUE}
#3) Mean and median number of steps taken each day
stepSummary <- as.table(summary(activityDataAg$totalSteps))
stepsMedian <- stepSummary[3]
stepsMean <- stepSummary[4]
```


``` {r include = TRUE, echo = TRUE}
# 4) Time series plot of the average number of steps taken
# removed na's
actDataAg <- activityDataAg[complete.cases(activityDataAg),]
#activityTS= ts(rnorm(48), start=c(2293,6), frequency=1)
plot(actDataAg$date,actDataAg$totalSteps,type = "l", xlab = "date",ylab = "total steps")
```



The date with the most 5 interval steps is `r activity5min[which(activity5min$avgsteps == max(activity5min$avgsteps)),"date"]`. The number of steps on this day was `r activity5min[which(activity5min$avgsteps == max(activity5min$avgsteps)),"avgsteps"]`

``` {r include = TRUE,echo = TRUE}
# 5
activity5min <- activityData[which(activityData$interval == 5),]
activity5min <- aggregate(activity5min$steps,list(activity5min$date),mean)
names(activity5min) <- c("date","avgsteps")
activity5min <- activity5min[complete.cases(activity5min),]
plot(activity5min$date,activity5min$avgsteps,type = "l", xlab = "date", ylab = "5min Avg Steps")

```


There are `r  nrow(activityData[!complete.cases(activityData),])` days that have NA's

``` {r include = TRUE, echo = TRUE}

#stepSummary <- as.table(summary(activityDataAg$totalSteps))
#rowsNA <- nrow(activityData[!complete.cases(activityData),])

```


Add a new chunk by clicking the *Insert Chunk* button on the toolbar or by pressing *Cmd+Option+I*.

When you save the notebook, an HTML file containing the code and output will be saved alongside it (click the *Preview* button or press *Cmd+Shift+K* to preview the HTML file).
